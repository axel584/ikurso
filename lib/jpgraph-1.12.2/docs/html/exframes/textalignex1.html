<code><font color="#000000">
<font color="#0000CC">&lt;?php<br /></font><font color="#FF9900">// $Id: textalignex1.php,v 1.1 2002/10/19 17:42:53 aditus Exp $<br /></font><font color="#006600">require_once </font><font color="#CC0000">"../jpgraph.php"</font><font color="#006600">;<br />require_once </font><font color="#CC0000">"../jpgraph_canvas.php"</font><font color="#006600">;<br /><br />if( empty(</font><font color="#0000CC">$_GET</font><font color="#006600">[</font><font color="#CC0000">'a'</font><font color="#006600">]) ) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$angle</font><font color="#006600">=</font><font color="#0000CC">40</font><font color="#006600">;<br />}<br />else {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$angle</font><font color="#006600">=</font><font color="#0000CC">$_GET</font><font color="#006600">[</font><font color="#CC0000">'a'</font><font color="#006600">];<br />}<br /><br /></font><font color="#0000CC">$caption </font><font color="#006600">= </font><font color="#CC0000">"Demonstration of different anchor points for texts as specified with\nTextAlign(). The red cross marks the coordinate that was given to\nstroke each instance of the string.\n(The green box is the bounding rectangle for the text.)"</font><font color="#006600">;<br /></font><font color="#0000CC">$txt</font><font color="#006600">=</font><font color="#CC0000">"TextAlign()"</font><font color="#006600">;<br /><br /><br /></font><font color="#FF9900">// Initial width and height since we need a "dummy" canvas to<br />// calculate the height of the text strings<br /></font><font color="#0000CC">$w</font><font color="#006600">=</font><font color="#0000CC">480</font><font color="#006600">;</font><font color="#0000CC">$h</font><font color="#006600">=</font><font color="#0000CC">50</font><font color="#006600">;<br /></font><font color="#0000CC">$xm</font><font color="#006600">=</font><font color="#0000CC">90</font><font color="#006600">;</font><font color="#0000CC">$ym</font><font color="#006600">=</font><font color="#0000CC">80</font><font color="#006600">;<br /><br /></font><font color="#0000CC">$g </font><font color="#006600">= new </font><font color="#0000CC">CanvasGraph</font><font color="#006600">(</font><font color="#0000CC">$w</font><font color="#006600">,</font><font color="#0000CC">$h</font><font color="#006600">);<br /><br /></font><font color="#0000CC">$aImg </font><font color="#006600">= </font><font color="#0000CC">$g</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">;<br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_ARIAL</font><font color="#006600">,</font><font color="#0000CC">FS_NORMAL</font><font color="#006600">,</font><font color="#0000CC">16</font><font color="#006600">);<br /></font><font color="#0000CC">$tw</font><font color="#006600">=</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">GetBBoxWidth</font><font color="#006600">(</font><font color="#0000CC">$txt</font><font color="#006600">,</font><font color="#0000CC">$angle</font><font color="#006600">);<br /></font><font color="#0000CC">$th</font><font color="#006600">=</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">GetBBoxHeight</font><font color="#006600">(</font><font color="#0000CC">$txt</font><font color="#006600">,</font><font color="#0000CC">$angle</font><font color="#006600">);<br /><br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_ARIAL</font><font color="#006600">,</font><font color="#0000CC">FS_NORMAL</font><font color="#006600">,</font><font color="#0000CC">11</font><font color="#006600">);<br /></font><font color="#0000CC">$ch</font><font color="#006600">=</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">GetBBoxHeight</font><font color="#006600">(</font><font color="#0000CC">$caption</font><font color="#006600">);<br /><br /></font><font color="#FF9900">// Calculate needed height for the image<br /></font><font color="#0000CC">$h </font><font color="#006600">= </font><font color="#0000CC">3</font><font color="#006600">*</font><font color="#0000CC">$th</font><font color="#006600">+</font><font color="#0000CC">2</font><font color="#006600">*</font><font color="#0000CC">$ym </font><font color="#006600">+ </font><font color="#0000CC">$ch</font><font color="#006600">;<br /></font><font color="#0000CC">$g </font><font color="#006600">= new </font><font color="#0000CC">CanvasGraph</font><font color="#006600">(</font><font color="#0000CC">$w</font><font color="#006600">,</font><font color="#0000CC">$h</font><font color="#006600">);<br /></font><font color="#0000CC">$aImg </font><font color="#006600">= </font><font color="#0000CC">$g</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">;<br /><br /></font><font color="#0000CC">$prof </font><font color="#006600">= array(</font><font color="#CC0000">'left'</font><font color="#006600">,</font><font color="#CC0000">'top'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'center'</font><font color="#006600">,</font><font color="#CC0000">'top'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'right'</font><font color="#006600">,</font><font color="#CC0000">'top'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'left'</font><font color="#006600">,</font><font color="#CC0000">'center'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'center'</font><font color="#006600">,</font><font color="#CC0000">'center'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'right'</font><font color="#006600">,</font><font color="#CC0000">'center'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'left'</font><font color="#006600">,</font><font color="#CC0000">'bottom'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'center'</font><font color="#006600">,</font><font color="#CC0000">'bottom'</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'right'</font><font color="#006600">,</font><font color="#CC0000">'bottom'</font><font color="#006600">);<br /></font><font color="#0000CC">$n </font><font color="#006600">= </font><font color="#0000CC">count</font><font color="#006600">(</font><font color="#0000CC">$prof</font><font color="#006600">)/</font><font color="#0000CC">2</font><font color="#006600">;<br /><br />for( </font><font color="#0000CC">$i</font><font color="#006600">=</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$r</font><font color="#006600">=</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$c</font><font color="#006600">=</font><font color="#0000CC">0</font><font color="#006600">; </font><font color="#0000CC">$i </font><font color="#006600">&lt; </font><font color="#0000CC">$n</font><font color="#006600">; ++</font><font color="#0000CC">$i </font><font color="#006600">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$x </font><font color="#006600">= </font><font color="#0000CC">$c</font><font color="#006600">*(</font><font color="#0000CC">$tw</font><font color="#006600">+</font><font color="#0000CC">$xm</font><font color="#006600">)+</font><font color="#0000CC">$xm</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$y </font><font color="#006600">= </font><font color="#0000CC">$r</font><font color="#006600">*(</font><font color="#0000CC">$th</font><font color="#006600">+</font><font color="#0000CC">$ym</font><font color="#006600">)+</font><font color="#0000CC">$ym</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">-</font><font color="#0000CC">10</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetColor</font><font color="#006600">(</font><font color="#CC0000">'blue'</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetTextAlign</font><font color="#006600">(</font><font color="#0000CC">$prof</font><font color="#006600">[</font><font color="#0000CC">$i</font><font color="#006600">*</font><font color="#0000CC">2</font><font color="#006600">],</font><font color="#0000CC">$prof</font><font color="#006600">[</font><font color="#0000CC">$i</font><font color="#006600">*</font><font color="#0000CC">2</font><font color="#006600">+</font><font color="#0000CC">1</font><font color="#006600">]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_ARIAL</font><font color="#006600">,</font><font color="#0000CC">FS_NORMAL</font><font color="#006600">,</font><font color="#0000CC">16</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">StrokeText</font><font color="#006600">(</font><font color="#0000CC">$x</font><font color="#006600">,</font><font color="#0000CC">$y</font><font color="#006600">,</font><font color="#0000CC">$txt</font><font color="#006600">,</font><font color="#0000CC">$angle</font><font color="#006600">,</font><font color="#CC0000">"left"</font><font color="#006600">,</font><font color="#0000CC">true</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetColor</font><font color="#006600">(</font><font color="#CC0000">'black'</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_FONT1</font><font color="#006600">,</font><font color="#0000CC">FS_BOLD</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetTextAlign</font><font color="#006600">(</font><font color="#CC0000">'center'</font><font color="#006600">,</font><font color="#CC0000">'top'</font><font color="#006600">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$align </font><font color="#006600">= </font><font color="#0000CC">sprintf</font><font color="#006600">(</font><font color="#CC0000">'("%s","%s")'</font><font color="#006600">,</font><font color="#0000CC">$prof</font><font color="#006600">[</font><font color="#0000CC">$i</font><font color="#006600">*</font><font color="#0000CC">2</font><font color="#006600">],</font><font color="#0000CC">$prof</font><font color="#006600">[</font><font color="#0000CC">$i</font><font color="#006600">*</font><font color="#0000CC">2</font><font color="#006600">+</font><font color="#0000CC">1</font><font color="#006600">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">StrokeText</font><font color="#006600">(</font><font color="#0000CC">$c</font><font color="#006600">*(</font><font color="#0000CC">$tw</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">+</font><font color="#0000CC">$xm</font><font color="#006600">)+</font><font color="#0000CC">$xm</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">+</font><font color="#0000CC">$tw</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">$r</font><font color="#006600">*(</font><font color="#0000CC">$th</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">+</font><font color="#0000CC">$ym</font><font color="#006600">)+</font><font color="#0000CC">$th</font><font color="#006600">+</font><font color="#0000CC">$ym</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">-</font><font color="#0000CC">4</font><font color="#006600">,</font><font color="#0000CC">$align</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$c</font><font color="#006600">++;<br />&nbsp;&nbsp;&nbsp;&nbsp;if( </font><font color="#0000CC">$c</font><font color="#006600">==</font><font color="#0000CC">3 </font><font color="#006600">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$c</font><font color="#006600">=</font><font color="#0000CC">0</font><font color="#006600">;</font><font color="#0000CC">$r</font><font color="#006600">++;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetTextAlign</font><font color="#006600">(</font><font color="#CC0000">'center'</font><font color="#006600">,</font><font color="#CC0000">'bottom'</font><font color="#006600">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_ARIAL</font><font color="#006600">,</font><font color="#0000CC">FS_ITALIC</font><font color="#006600">,</font><font color="#0000CC">11</font><font color="#006600">);<br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">StrokeText</font><font color="#006600">(</font><font color="#0000CC">$w</font><font color="#006600">/</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">$h</font><font color="#006600">-</font><font color="#0000CC">10</font><font color="#006600">,</font><font color="#0000CC">$caption</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#CC0000">'left'</font><font color="#006600">);<br /><br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">SetColor</font><font color="#006600">(</font><font color="#CC0000">'navy'</font><font color="#006600">);<br /></font><font color="#0000CC">$aImg</font><font color="#006600">-&gt;</font><font color="#0000CC">Rectangle</font><font color="#006600">(</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$w</font><font color="#006600">-</font><font color="#0000CC">1</font><font color="#006600">,</font><font color="#0000CC">$h</font><font color="#006600">-</font><font color="#0000CC">1</font><font color="#006600">);<br /><br /></font><font color="#0000CC">$g</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">();<br /><br /></font><font color="#0000CC">?&gt;<br /></font><br /></font>
</code>